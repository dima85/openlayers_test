<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="http://openlayers.org/en/v3.17.1/css/ol.css" type="text/css">
    <style>
      .map {
        height: 600px;
        width: 100%;
      }

      .ol-custom-overviewmap,
      .ol-custom-overviewmap.ol-uncollapsible {
        bottom: auto;
        left: auto;
        right: 0;
        top: 0;
      }

      .ol-custom-overviewmap:not(.ol-collapsed)  {
        border: 1px solid black;
      }

      .ol-custom-overviewmap .ol-overviewmap-map {
        border: none;
        width: 300px;
      }

      .ol-custom-overviewmap .ol-overviewmap-box {
        border: 2px solid red;
      }

      .ol-custom-overviewmap:not(.ol-collapsed) button{
        bottom: auto;
        left: auto;
        right: 1px;
        top: 1px;
      }

      .ol-rotate {
        top: 170px;
        right: 0;
      }

    </style>

    <script src="http://openlayers.org/en/v3.17.1/build/ol.js" type="text/javascript"></script>
<!--     <script type="text/javascript" src="./scripts/map_xyz.js"></script> -->


    <title>OpenLayers 3 example</title>

  </head>
  <body>
    <h2>My Map</h2>
    <div id="map" class="map"></div>
    <form class="form-inline">
      <label>Geometry type &nbsp;</label>
      <select id="type">
        <option value="Point">Point</option>
        <option value="LineString">LineString</option>
        <option value="Polygon">Polygon</option>
      </select>
      <button onclick="readData(event)">Read</button>
    </form>



    <script type="text/javascript">
      // http://jsfiddle.net/jonataswalker/6f233kLy/
      // http://stackoverflow.com/questions/35928163/openlayers-3-static-tiles-and-xyz-coordinates
      var maxZoolLevel = 2;
      var sizeX = 4096;
      var sizeY = 4096;
      var tileSize = 512;
      var tilesCountX = sizeX / tileSize;

      var pixelProj = new ol.proj.Projection({
        code: 'pixel',
        units: 'pixels',
        extent: [0, 0, sizeX, sizeY]
      });

      var projectionExtent = pixelProj.getExtent();

      var maxResolution = ol.extent.getWidth(projectionExtent) / tileSize;
      var resolutions = [];
      for (var z = 0; z <= maxZoolLevel; z++) {
          //resolutions[z] = maxResolution / Math.pow(2, z+1);
          resolutions.push((maxResolution / Math.pow(2, z+1)) ) ;
      }
      console.log(resolutions);
      /*var resolutions = [
        tilesCountX/4,
        tilesCountX/4/2,
        tilesCountX/4/4
      ];*/

      var tileGrid = new ol.tilegrid.TileGrid({
        origin: ol.extent.getTopLeft(projectionExtent),
        resolutions: resolutions,
        tileSize: tileSize
      });

      var source = new ol.source.XYZ({
        projection: pixelProj,
        wrapX: false,
        url: '/tile/{z}/{x}/{y}',
        tileGrid: tileGrid
      });

      var tileLayer = new ol.layer.Tile({
        source: source,
        extent: projectionExtent
      });

      var view = new ol.View({
        zoom: 0,
        minZoom: 0,
        maxZoom: maxZoolLevel + 2,
        renderer: 'canvas',
        center: [sizeX/2, sizeY/2],
        projection: pixelProj,
        extent: projectionExtent, // restrict image going outside screen
        //resolutions: resolutions // restrict zoomout level

      });

      var map = new ol.Map({
        target: 'map',
        layers: [tileLayer],
        view: view,
        controls: ol.control.defaults({
          attributionOptions: /** @type {olx.control.AttributionOptions} */
          {
            collapsible: false
          }
        })
        .extend([
          //new ol.control.OverviewMap({collapsed: false}),
          initOverviewMap(),
          new ol.control.ZoomSlider()
        ])
      });

      function initOverviewMap() {

        var pixelProj1 = new ol.proj.Projection({
          code: 'pixel',
          units: 'pixels',
          extent: [0, 0, sizeX, sizeY]
        });

        var projectionExtent1 = pixelProj.getExtent();

        var maxResolution1 = ol.extent.getWidth(projectionExtent1) / tileSize;
        var resolutions1 = [];
        for (var z = 0; z <= 1; z++) {
            //resolutions[z] = maxResolution / Math.pow(2, z+1);
            resolutions1.push((maxResolution1 / Math.pow(2, z+1)) ) ;
        }
        console.log(resolutions1);
        /*var resolutions = [
          tilesCountX/4,
          tilesCountX/4/2,
          tilesCountX/4/4
        ];*/

        var tileGrid1 = new ol.tilegrid.TileGrid({
          origin: ol.extent.getTopLeft(projectionExtent1),
          resolutions: resolutions1,
          tileSize: tileSize
        });

        var source1 = new ol.source.XYZ({
          projection: pixelProj1,
          wrapX: false,
          url: '/tile/{z}/{x}/{y}',
          tileGrid: tileGrid1
        });

        var tileLayer1 = new ol.layer.Tile({
          source: source1,
          extent: projectionExtent1
        });

        var overviewMapControl1 = new ol.control.OverviewMap({
          collapsible: false,
          collapsed: false,
          className: 'ol-overviewmap ol-custom-overviewmap',
          layers: [
            tileLayer1
          ],
          collapseLabel: '\u00BB',
          label: '\u00AB',
          collapsed: false
        });
        return overviewMapControl1;
      }

    </script>


  </body>
</html>
